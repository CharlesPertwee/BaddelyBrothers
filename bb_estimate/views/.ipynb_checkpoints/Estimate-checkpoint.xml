<odoo>
  <data>
      <report
        id="report_estimate"
        model="bb_estimate.estimate"
        string="Estimate Letter"
        report_type="qweb-html"
        name="bb_estimate.estimate_letter"
        file="mrp_account.mrp_cost_structure"
        paperformat="bb_estimate.paperformat_invoice"
        attachment="((object.estimate_number or '').replace('/','')+'.pdf')"
        print_report_name="(object.estimate_number or '')"
      />
          
    <record id="estimate_tree_view" model="ir.ui.view">
        <field name="name">estimate.tree</field>
        <field name="model">bb_estimate.estimate</field>
        <field name="arch" type="xml">
            <tree string="Estimate">
                <field name="estimate_number" />
                <field name="estimate_date" />
                <field name="title" />
                <field name="partner_id" />
                <field name="project" />
                <field name="estimator" />
                <field name="state" />
            </tree>
        </field>
    </record>
    
    <record id="estimate_form_view" model="ir.ui.view">
        <field name="name">estimate.form</field>
        <field name="model">bb_estimate.estimate</field>
        <field name="arch" type="xml">
            <form string="Estimate">
                <field name="isEnvelope" invisible="1" />
                <field name="showMo" invisible="1" />
                <field name="isLocked" invisible="1" />
                <header>
                    <button name="AddDelivery" string="Set Delivery" type="object" attrs="{'invisible':['|',('id','=',False),('isLocked','!=',False)]}"/>
                    <button name="AdjustPrice" string="Adjust Prices" type="object" attrs="{'invisible':['|',('id','=',False),('isLocked','!=',False)]}"/>
                    <field name="state" widget="statusbar" clickable="True" />
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                      <button class="oe_stat_button" icon="fa-database" type="object" name="AddLineItem" attrs="{'invisible':['|',('id','=',False),('isLocked','!=',False)]}">
                          <span>Add Line</span>
                      </button>
                      <button class="oe_stat_button" icon="fa-database" type="object" name="CreateManufacturingOrder" attrs="{'invisible':['|',('showMo','=',False),('isLocked','!=',False)]}">
                          <span>Create Job</span>
                      </button>
                    </div>
                    
                    <h1>
                        <field name="title" placeholder="Estimate Title" />
                    </h1>
                    <group>
                        <group>
                            <field name="partner_id"  options="{'no_create_edit': True}" domain="[('is_company','=',True)]" />
                            <field name="contact"  options="{'no_create_edit': True}" domain="[('parent_id','=',partner_id)]" />
                            <field name="project" options="{'no_create_edit': True}" domain="[('partner_id','=',partner_id)]"/>
                            <field name="invoice_account" options="{'no_create_edit': True}" required="1"/>
                            <field name="invoice_address" options="{'no_create_edit': True}" domain="[('parent_id','=',invoice_account),('type','=','invoice')]" required="1"/>
                            <field name="invoice_contact" options="{'no_create_edit': True}" domain="[('parent_id','=',invoice_account)]" required="1"/>
                        </group>
                        <group>
                            <field name="product_type" options="{'no_create_edit': True}" domain="[('productType','=','Finished')]" required="1"/> <!-- <domain="[('categ_id.name','=','Finished Goods')]" /-->
                            <field name="estimate_date" required="1"/>
                            <field name="estimator" options="{'no_create_edit': True}" required="1"/>
                            <field name="office_copy" />
                            <field name="estimate_number" readonly="1"/>
                            <field name="event_date" />
                            <field name="target_dispatch_date" required="1"/>
                        </group>
                    </group>
                    <notebook>
                        <page name="EstimateDetails" string="Estimate Details">
                            <group>
                                <group>
                                    <field name="quantity_1" required="1" attrs="{'readonly':[('estimate_line','=',False)]}"/>
                                    <field name="quantity_2" attrs="{'readonly':[('estimate_line','=',False)]}"/>
                                    <field name="run_on" attrs="{'readonly':[('estimate_line','=',False)]}"/>
                                    <field name="number_up" attrs="{'readonly':[('estimate_line','=',False)]}"/>
                                </group>
                                <group>
                                    <field name="quantity_3" attrs="{'readonly':[('estimate_line','=',False)]}"/>
                                    <field name="quantity_4" attrs="{'readonly':[('estimate_line','=',False)]}"/>
                                    <field name="grammage" attrs="{'readonly':[('estimate_line','=',False)]}"/>
                                </group>
                            </group>
                            <div class="container">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <div class='row'>
                                                <div class='col-md-6'>
                                                    <label for="working_size" class="col-md-4"/>
                                                    <field name="working_size" class="col-md-7"/>
                                                </div>
                                                <div class='col-md-6'>
                                                    <div class="row">
                                                        <div class='form-group'>
                                                            <label for="working_height"  class="col-md-4"/>
                                                            <field name="working_height" class="col-md-7"/>
                                                        </div>
                                                        <div class='form-group'>
                                                            <label for="working_width" class="col-md-4"/>
                                                            <field name="working_width" class="col-md-7"/>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                           <div class='row'>
                                              <div class='col-md-6'>
                                                  <label for="finished_size" class="col-md-4"/>
                                                  <field name="finished_size" class="col-md-7"/>
                                               </div>
                                               <div class='col-md-6'>
                                                   <div class="row">
                                                       <div class='form-group'>
                                                           <label for="finished_height" class="col-md-4"/>
                                                           <field name="finished_height" class="col-md-7"/>
                                                       </div>
                                                       <div class='form-group'>
                                                          <label for="finished_width" class="col-md-4"/>
                                                          <field name="finished_width" class="col-md-7"/>
                                                       </div>
                                                   </div>
                                               </div>
                                           </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </page>
                        <page string="Envelope Details" attrs="{'invisible':[('isEnvelope','=',False)]}">
                            <group>
                                <group>
                                    <field name="envelope_type"/>
                                    <field name="flap_glue_type"/>
                                    <field name="embossed"/>
                                </group>
                                <group>                                    
                                    <field name="tissue_lined"/>
                                    <field name="knife_number"/>
                                    <field name="windowed"/>
                                </group>
                            </group>
                            <group attrs="{'invisible':[('windowed','!=',True)]}">
                                <group>
                                    <field name="standardWindowSize"/>
                                </group>
                                <group attrs="{'invisible':[('standardWindowSize','!=',True)]}">
                                    <field name="windowHeight"/>
                                    <field name="windowWidth"/>
                                    <field name="windowFlhs"/>
                                    <field name="windowUp"/>
                                </group>
                            </group>
                        </page>
                        <page name="EstimateLines" string="Estimate Lines" attrs="{'invisible':[('id','=',False)]}">
                            <field name="estimate_line"/>
                        </page>
                        <page string="Estimate Conditions" attrs="{'invisible':[('id','=',False)]}">
                            <field name="estimateConditions"/>
                        </page>
                        <page string="Order Details" attrs="{'invisible':[('manufacturingOrder','=',False)]}">
                            <sheet>
                                <group>
                                    <field name="manufacturingOrder" readonly="1"/>
                                    <field name="salesOrder" readonly="1" />
                                    <field name="routings" readonly="1"/>
                                    <field name="bom" readonly="1"/>
                                </group>
                            </sheet>
                        </page>
                        <page string="Estimate Summary" invisible="1">
                            <sheet>
                                <group col="3">
                                    <group>
                                        <field name="total_price_1" readonly="1"/>
                                        <field name="total_price_2" readonly="1"/>
                                        <field name="total_price_3" readonly="1"/>
                                        <field name="total_price_4" readonly="1"/>
                                        <field name="total_price_run_on" readonly="1"/>
                                        <field name="total_price_1000_1" readonly="1"/>
                                        <field name="total_price_1000_2" readonly="1"/>
                                        <field name="total_price_1000_3" readonly="1"/>
                                        <field name="total_price_1000_4" readonly="1"/>
                                        <field name="total_price_1000_run_on" readonly="1"/>
                                        <field name="total_cost_1" readonly="1"/>
                                        <field name="total_cost_2" readonly="1"/>
                                        <field name="total_cost_3" readonly="1"/>
                                        <field name="total_cost_4" readonly="1"/>
                                        <field name="total_cost_run_on" readonly="1"/> 
                                    </group>
                                    <group>
                                        <field name="unAllocated_1" />
                                        <field name="unAllocated_2" />
                                        <field name="unAllocated_3" />
                                        <field name="unAllocated_4" />
                                        <field name="unAllocated_run_on" />
                                     </group>
                                    <group>
                                        <field name="selectedQuantity" readonly="1"/>
                                        <field name="selectedRunOn" readonly="1"/>
                                        <field name="selectedPrice" readonly="1"/>
                                        <field name="selectedRatio" readonly="1"/>
                                    </group>
                                </group>
                            </sheet>
                        </page>
                    </notebook>
                    <group>
                        <group>
                            <field name="EnquiryComments" />
                        </group>
                        <group>
                            <field name="SpecialInstuction" />
                            <field name="PackingInstruction" />
                        </group>
                    </group>
                    <group>
                        <group>
                            <field name="Delivery" />
                            <field name="DeliveryContact" />
                        </group>
                        
                        <group>
                            <field name="DeliveryMethod" domain="[('delivery_type','=','base_on_rule')]"/>
                            <field name="DeliveryLabel" />
                        </group>
                    </group>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>  
     
    <record model="ir.ui.view" id="estimate_kanban_view">
       <field name="name">estimate.kanban</field>
       <field name="model">bb_estimate.estimate</field>
       <field name="arch" type="xml">
           <kanban default_group_by="state" class="o_kanban_small_column">
               <field name="state" options='{"group_by_tooltip": {"description": "Stage Description"}}'/>
               <field name="target_dispatch_date"/>
               <templates>
                   <t t-name="kanban-box">
                       <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                           <div class="oe_kanban_content">
                               <div class="o_kanban_record_top">
                                   <div class="o_kanban_record_headings">
                                       <strong class="o_kanban_record_title"><field name="title"/></strong><br/>
                                       <small class="o_kanban_record_subtitle text-muted">
                                           <t t-if="record.target_dispatch_date.raw_value and record.target_dispatch_date.raw_value lt (new Date())" t-set="red">oe_kanban_text_red</t>
                                           <span t-attf-class="#{red || ''}"><i><field name="target_dispatch_date"/></i></span>
                                       </small>
                                   </div>
                               </div>
                               <div class="o_kanban_record_body">
                                   <strong class="o_kanban_record_title"><field name="estimator"/></strong><br/>
                                   <small class="o_kanban_record_subtitle text-muted">
                                       <span t-attf-class="#{red || ''}"><i><field name="estimate_number"/></i></span>
                                   </small>
                               </div>
                           </div>
                       </div>
                   </t>
              </templates>
           </kanban>
       </field>
    </record>
    
    <record id="estimate_graph_view" model="ir.ui.view">
        <field name="name">estimate.graph</field>
        <field name="model">bb_estimate.estimate</field>
        <field name="arch" type="xml">
            <graph string="Estimates">
                <!--<field name="id"/>-->
                <field name="state"/>
            </graph>
        </field>
    </record>
      
    <record model="ir.actions.act_window" id="bb_estimate.action_window_estimate">
        <field name="name">Estimates</field>
        <field name="res_model">bb_estimate.estimate</field>
        <field name="view_type">form</field>
        <field name="view_mode">kanban,tree,form,graph</field>
        <field name="domain">[]</field>
        <field name="help" type="html">
           <p class="oe_view_nocontent_create">Create New Estimate</p>
        </field>
    </record>
      
    <menuitem name="Job Estimates" id="bb_estimate_estimates" action="bb_estimate.action_window_estimate"/>
    <menuitem name="Configurations" id="bb_estimate_config" parent="bb_estimate_estimates"/>
  </data>
</odoo>