<odoo>
  <data>
     <record id="bb_estimate_enquiry" model="ir.actions.act_window">
        <field name="name">Enquiry</field>
        <field name="res_model">bb_estimate.estimate</field>
        <field name="view_mode">form,tree,kanban</field>
        <field name="domain">[('lead', '=', active_id)]</field>
        <field name="context">{'default_lead': active_id}</field>
     </record>
     <record id="bb_estimate_enquiry_list" model="ir.actions.act_window">
        <field name="name">Estimates</field>
        <field name="res_model">bb_estimate.estimate</field>
        <field name="domain">[('lead', '=', active_id)]</field>
        <field name="context">{'default_lead': active_id}</field>
    </record> 
    
      <record id="crm_case_form_view_oppor_pro_estimate" model="ir.ui.view">
		<field name="name">crm.lead.form.opportunity.estimate</field>
		<field name="model">crm.lead</field>
		<field name="inherit_id" ref="bb_crm.crm_case_form_view_oppor_bb"/>
		<field name="arch" type="xml">
            <xpath expr="//header" position="inside">
                    <button string="New Estimate" name="%(bb_estimate_enquiry)d" type="action" class="oe_highlight"
                            attrs="{'invisible': ['|','&amp;',  ('probability', '=', 0), ('active', '=', False), ('typeOfLead','=','Trade Counter')]}"
                            context="{'default_lead': active_id, 'default_project': Project, 'default_partner_id': partner_id }" />

                </xpath>
            <xpath expr="//field[@name='typeOfLead']" position="after">
                <field name="Project" options="{'no_create_edit': True}" domain="[('partner_id','=',partner_id)]"/>
            </xpath>
		</field>
	 </record>

      <record id="crm_case_form_view_oppor_estimate" model="ir.ui.view">
            <field name="name">crm.lead.oppor.inherited.estimate</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="sale_crm.crm_case_form_view_oppor"/>
            <field name="arch" type="xml">
                <button name="action_schedule_meeting" position="after">
                    <button class="oe_stat_button" type="action"
                            name="%(bb_estimate_enquiry_list)d" icon="fa-pencil-square-o"
                            attrs="{'invisible': [('typeOfLead','=','Trade Counter')]}"
                        >
                        <div class="o_stat_info">
                            <field name="Estimate_Count" class="o_stat_value"/>
                            <span class="o_stat_text"> Estimate(s) </span>
                        </div>
                    </button>
                </button>

                
                <xpath expr="//button[@name='%(sale_crm.sale_action_quotations_new)d']" position="replace">            
                    <button string="New Quotation" name="%(sale_crm.sale_action_quotations_new)d" type="action" class="oe_highlight"
                            attrs="{'invisible': ['|' ,'&amp;',('probability', '=', 0), ('active', '=', False),('typeOfLead','=','Bespoke')]}"
                            context="{'search_default_partner_id': partner_id,
                                      'default_partner_id': partner_id,
                                      'default_team_id': team_id,
                                      'default_campaign_id': campaign_id,
                                      'default_medium_id': medium_id,
                                      'default_origin': name,
                                      'default_source_id': source_id}"/>      
                </xpath>

                <button name="%(sale_crm.sale_action_quotations)d" position="replace">
                    <button class="oe_stat_button" type="action"
                                name="%(sale_crm.sale_action_quotations)d" icon="fa-pencil-square-o"
                                context="{'default_partner_id': partner_id, 'search_default_draft': 1, 'search_default_sent': 1}"
                                attrs="{'invisible': [('typeOfLead','=','Bespoke')]}"
                            >
                            <div class="o_stat_info">
                                <field name="sale_number" class="o_stat_value"/>
                                <span class="o_stat_text"> Quotation(s) </span>
                            </div>
                        </button>
                </button>

            </field>
         </record>
     
    
<!--       <record id="crm_case_form_view_leads_bb" model="ir.ui.view">
		<field name="name">crm.lead.form.lead.bb</field>
		<field name="model">crm.lead</field>
		<field name="inherit_id" ref="crm.crm_case_form_view_leads"/>
		<field name="arch" type="xml">
            
            <xpath expr="//field[@name='mobile']" position="after">
                <field name="typeOfLead" />
            </xpath>
            
		</field>
	 </record>	 -->
      

      
  </data>
</odoo>
