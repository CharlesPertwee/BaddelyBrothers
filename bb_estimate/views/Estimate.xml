<odoo>
  <data>
      <record id="view_estimates_filter" model="ir.ui.view">
            <field name="name">estimate.search.select</field>
            <field name="model">bb_estimate.estimate</field>
            <field name="priority" eval="15"/>
            <field name="arch" type="xml">
                <search string="Search Sales Order">
                    <field name="title"/>
                    <field name="estimate_number"/>
                    <field name="partner_id"/>
                    <field name="estimator"/>
                </search>
          </field>
      </record>
          
    <record id="estimate_tree_view" model="ir.ui.view">
        <field name="name">estimate.tree</field>
        <field name="model">bb_estimate.estimate</field>
        <field name="arch" type="xml">
            <tree string="Estimate">
                <field name="estimate_number" />
                <field name="estimate_date" />
                <field name="title" />
                <field name="partner_id" />
                <field name="project" />
                <field name="estimator" />
                <field name="state" />
            </tree>
        </field>
    </record>
    
    <record id="estimate_form_view" model="ir.ui.view">
        <field name="name">estimate.form</field>
        <field name="model">bb_estimate.estimate</field>
        <field name="arch" type="xml">
            <form string="Estimate">
                <field name="isEnvelope" invisible="1" />
                <field name="showMo" invisible="1" />
                <field name="isLocked" invisible="1" />
                <field name="hasDelivery" invisible="1" />
                <header>
                    <button class="oe_stat_button" type="object" name="EstimateLetter" string="Print Letter" />
                    <button name="AdjustPrice" string="Adjust Prices" type="object" attrs="{'invisible':['|',('id','=',False),('isLocked','!=',False)]}"/>
                    <button name="AmmendQty" string="Amend Qty" type="object" attrs="{'invisible':['|',('isLocked','=',False),('AppendLog','=',True)]}"/>
                    <field name="state" widget="statusbar" clickable="True" />
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                      <button name="AddDelivery" icon="fa-plus" type="object" attrs="{'invisible':['|','|',('id','=',False),('hasDelivery','!=',False),('isLocked','!=',False)]}">
                          <span>Set Delivery</span>
                      </button>
                      <button class="oe_stat_button" icon="fa-plus" type="object" name="AddLineItem" attrs="{'invisible':['|',('id','=',False),('isLocked','!=',False)]}">
                          <span>Add Line</span>
                      </button>
                      <button class="oe_stat_button" icon="fa-play" type="object" name="CreateManufacturingOrder" attrs="{'invisible':['|',('showMo','=',False),('isLocked','!=',False)]}">
                          <span>Create Job</span>
                      </button>
                    </div>
                    
                    <h1>
                        <field name="title" placeholder="Estimate Title" />
                    </h1>
                    <group>
                        <group>
                            <field name="partner_id" attrs="{'readonly':[('isLocked','=',True)]}" options="{'no_create_edit': True}" domain="[('is_company','=',True)]" />
                            <field name="contact" attrs="{'readonly':[('isLocked','=',True)]}" options="{'no_create_edit': True}" domain="[('parent_id','=',partner_id)]" />
                            <field name="project" attrs="{'readonly':[('isLocked','=',True)]}" options="{'no_create_edit': True}" domain="['|','|',('partner_id','=',partner_id),('partner_id','parent_of',partner_id),('partner_id','=',False)]" widget="selection"/>
                            <field name="invoice_account" options="{'no_create_edit': True}" required="1" attrs="{'readonly':[('isLocked','=',True)]}"/>
                            <field name="AppendLog" invisible="1"/>
                            <field name="lead" attrs="{'readonly':[('isLocked','=',True)]}" domain="[('typeOfLead','=','Bespoke')]" />
                        </group>
                        <group>
                            <field name="product_type" attrs="{'readonly':[('isLocked','=',True)]}" options="{'no_create_edit': True}" domain="[('productType','=','Finished')]" required="1"/> <!-- <domain="[('categ_id.name','=','Finished Goods')]" /-->
                            <field name="estimate_date" attrs="{'readonly':[('isLocked','=',True)]}" required="1"/>
                            <field name="estimator" attrs="{'readonly':[('isLocked','=',True)]}" options="{'no_create_edit': True}" required="1"/>
                            <field name="office_copy" attrs="{'readonly':[('isLocked','=',True)]}"/>
                            <field name="estimate_number" attrs="{'readonly':[('isLocked','=',True)]}" readonly="1"/>
                            <field name="event_date" attrs="{'readonly':[('isLocked','=',True)]}"/>
                            <field name="target_dispatch_date" attrs="{'readonly':[('isLocked','=',True)]}" required="1"/>
                            <field name="analytic_account" widget="selection"/>
                        </group>
                    </group>
                    <group>
                        <field name="ChangeLog" readonly="1"/>
                    </group>
                    <notebook>
                        <page name="EstimateDetails" string="Estimate Details">
                            <group>
                                <group>
                                    <field name="quantity_1" required="1" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                    <field name="quantity_2" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                    <field name="run_on" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                    <field name="number_up" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                </group>
                                <group>
                                    <field name="quantity_3" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                    <field name="quantity_4" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                    <field name="grammage" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                </group>
                            </group>
                            <div class="container">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <div class='row'>
                                                <div class='col-md-6'>
                                                    <label for="working_size" class="col-md-4"/>
                                                    <field name="working_size" class="col-md-7" attrs="{'readonly':[('isLocked','=',True)]}" domain="['|',('isEnvelopeEstimate','=',isEnvelope),('isPrintSize','!=',isEnvelope)]"/>
                                                </div>
                                                <div class='col-md-6'>
                                                    <div class="row">
                                                        <div class='form-group'>
                                                            <label for="working_height"  class="col-md-4"/>
                                                            <field name="working_height" class="col-md-7" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                                        </div>
                                                        <div class='form-group'>
                                                            <label for="working_width" class="col-md-4"/>
                                                            <field name="working_width" class="col-md-7" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                           <div class='row'>
                                              <div class='col-md-6'>
                                                  <label for="finished_size" class="col-md-4"/>
                                                  <field name="finished_size" class="col-md-7" attrs="{'readonly':[('isLocked','=',True)]}" domain="['|',('isEnvelopeEstimate','=',isEnvelope),('isPrintSize','!=',isEnvelope)]"/>
                                               </div>
                                               <div class='col-md-6'>
                                                   <div class="row">
                                                       <div class='form-group'>
                                                           <label for="finished_height" class="col-md-4"/>
                                                           <field name="finished_height" class="col-md-7" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                                       </div>
                                                       <div class='form-group'>
                                                          <label for="finished_width" class="col-md-4"/>
                                                          <field name="finished_width" class="col-md-7" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                                       </div>
                                                   </div>
                                               </div>
                                           </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </page>
                        <page string="Envelope Details" attrs="{'invisible':[('isEnvelope','=',False)]}">
                            <group>
                                <group>
                                    <field name="envelope_type" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                    <field name="flap_glue_type" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                    <field name="embossed" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                </group>
                                <group>                                    
                                    <field name="tissue_lined" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                    <field name="knife_number" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                    <field name="windowed" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                </group>
                            </group>
                            <group attrs="{'invisible':[('windowed','!=',True)]}">
                                <group>
                                    <field name="standardWindowSize" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                </group>
                                <group attrs="{'invisible':[('standardWindowSize','!=',True)]}">
                                    <field name="windowHeight" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                    <field name="windowWidth" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                    <field name="windowFlhs" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                    <field name="windowUp" attrs="{'readonly':[('isLocked','=',True)]}"/>
                                </group>
                            </group>
                        </page>
                        <page name="EstimateLines" string="Estimate Lines" attrs="{'invisible':[('id','=',False)]}">
                            <field name="estimate_line" />
                        </page>
                        <page string="Estimate Conditions">
                            <field name="estimateConditions" attrs="{'readonly':[('isLocked','=',True)]}"/>
                        </page>
                        <page name="PriceAdjustments" string="Price Adjustments">
                            <field name="priceHistory" readonly="1">
                                <tree>
                                    <field name="CurrentPrice1" />
                                    <field name="CurrentPrice2" />
                                    <field name="CurrentPrice3" />
                                    <field name="CurrentPrice4" />
                                    <field name="CurrentPriceRunOn" />
                                    <field name="ChangedPrice1" />
                                    <field name="ChangedPrice2" />
                                    <field name="ChangedPrice3" />
                                    <field name="ChangedPrice4" />
                                    <field name="ChangedPriceRunOn" />
                                    <field name="create_uid" string="By"/>
                                    <field name="create_date" string="On" />
                                 </tree>
                            </field>
                        </page>
                        <page string="Order Details" attrs="{'invisible':[('manufacturingOrder','=',False)]}">
                            <sheet>
                                <group>
                                    <field name="manufacturingOrder" readonly="1"/>
                                    <field name="salesOrder" readonly="1" />
                                    <field name="routings" readonly="1"/>
                                    <field name="bom" readonly="1"/>
                                </group>
                            </sheet>
                        </page>
                        <page string="Estimate Summary" invisible="1">
                            <sheet>
                                <group col="3">
                                    <group>
                                        <field name="total_price_1" readonly="1"/>
                                        <field name="total_price_2" readonly="1"/>
                                        <field name="total_price_3" readonly="1"/>
                                        <field name="total_price_4" readonly="1"/>
                                        <field name="total_price_run_on" readonly="1"/>
                                        <field name="total_price_1000_1" readonly="1"/>
                                        <field name="total_price_1000_2" readonly="1"/>
                                        <field name="total_price_1000_3" readonly="1"/>
                                        <field name="total_price_1000_4" readonly="1"/>
                                        <field name="total_price_1000_run_on" readonly="1"/>
                                        <field name="total_cost_1" readonly="1"/>
                                        <field name="total_cost_2" readonly="1"/>
                                        <field name="total_cost_3" readonly="1"/>
                                        <field name="total_cost_4" readonly="1"/>
                                        <field name="total_cost_run_on" readonly="1"/> 
                                    </group>
                                    <group>
                                        <field name="unAllocated_1" />
                                        <field name="unAllocated_2" />
                                        <field name="unAllocated_3" />
                                        <field name="unAllocated_4" />
                                        <field name="unAllocated_run_on" />
                                     </group>
                                    <group>
                                        <field name="selectedQuantity" readonly="1"/>
                                        <field name="selectedRunOn" readonly="1"/>
                                        <field name="selectedPrice" readonly="1"/>
                                        <field name="selectedRatio" readonly="1"/>
                                        <field name="SelectedQtyRatio" readonly="1"/>
                                    </group>
                                    <group>
                                        <field name="Weight_1" />
                                        <field name="Weight_2" />
                                        <field name="Weight_3" />
                                        <field name="Weight_4" />
                                        <field name="Weight_run_on" />
                                    </group>
                                </group>
                            </sheet>
                        </page>
                    </notebook>
                    
                    <group col="15">
                        <label for="total_price_1" string="Prices" colspan="10"/>
                        <field name="total_price_1" nolabel="1" readonly="1"/>
                        <field name="total_price_2" nolabel="1" readonly="1"/>
                        <field name="total_price_3" nolabel="1" readonly="1" />
                        <field name="total_price_4" nolabel="1" readonly="1"/>
                        <field name="total_price_run_on" nolabel="1" readonly="1"/>
                    </group>
                    
                    <group>
                        <group>
                            <field name="EnquiryComments"/>
                        </group>
                        <group>
                            <field name="SpecialInstuction" class="textarea" string="Special Instruction"/>
                            <!--field name="PackingInstruction" /-->
                        </group>
                    </group>
                    <group>
                        <group>
                            <field name="Delivery" attrs="{'readonly':[('isLocked','=',True)]}"/>
                        </group>
                        
                        <group>
                            <field name="DeliveryMethod" attrs="{'readonly':[('isLocked','=',True)]}" domain="[('delivery_type','=','base_on_rule')]"/>
                            <field name="DeliveryLabel" attrs="{'readonly':[('isLocked','=',True)]}" />
                        </group>
                    </group>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>  
     
    <record model="ir.ui.view" id="estimate_kanban_view">
       <field name="name">estimate.kanban</field>
       <field name="model">bb_estimate.estimate</field>
       <field name="arch" type="xml">
           <kanban default_group_by="state" class="o_kanban_small_column">
               <field name="state" options='{"group_by_tooltip": {"description": "Stage Description"}}'/>
               <field name="target_dispatch_date"/>
               <templates>
                   <t t-name="kanban-box">
                       <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                           <div class="oe_kanban_content">
                               <div class="o_kanban_record_top">
                                   <div class="o_kanban_record_headings">
                                       <strong class="o_kanban_record_title"><field name="title"/></strong><br/>
                                       <small class="o_kanban_record_subtitle text-muted">
                                           <t t-if="record.target_dispatch_date.raw_value and record.target_dispatch_date.raw_value lt (new Date())" t-set="red">oe_kanban_text_red</t>
                                           <span t-attf-class="#{red || ''}"><i><field name="target_dispatch_date"/></i></span>
                                       </small>
                                   </div>
                               </div>
                               <div class="o_kanban_record_body">
                                   <strong class="o_kanban_record_title"><field name="estimator"/></strong><br/>
                                   <small class="o_kanban_record_subtitle text-muted">
                                       <span t-attf-class="#{red || ''}"><i><field name="estimate_number"/></i></span>
                                   </small>
                               </div>
                           </div>
                       </div>
                   </t>
              </templates>
           </kanban>
       </field>
    </record>
    
    <record id="estimate_graph_view" model="ir.ui.view">
        <field name="name">estimate.graph</field>
        <field name="model">bb_estimate.estimate</field>
        <field name="arch" type="xml">
            <graph string="Estimates">
                <!--<field name="id"/>-->
                <field name="state"/>
            </graph>
        </field>
    </record>
      
    <record model="ir.actions.act_window" id="bb_estimate.action_window_estimate">
        <field name="name">Estimates</field>
        <field name="res_model">bb_estimate.estimate</field>
        <field name="view_type">form</field>
        <field name="view_mode">kanban,tree,form,graph</field>
        <field name="domain">[]</field>
        <field name="help" type="html">
           <p class="oe_view_nocontent_create">Create New Estimate</p>
        </field>
    </record>
      
    <menuitem name="Estimating" id="bb_estimate_estimates" action="bb_estimate.action_window_estimate"/>
    <menuitem name="Configurations" id="bb_estimate_config" parent="bb_estimate_estimates" groups="bb_estimate.group_estimate_manager"/>
    <menuitem name="Reporting" id="bb_estimate_reports" parent="bb_estimate_estimates"/>
  </data>
</odoo>
